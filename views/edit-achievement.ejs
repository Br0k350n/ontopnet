<!DOCTYPE html>
<html lang="en">
    <%- include('partials/head', {title: "Template", tag: "City On Top", isAdmin: true}); %>
<body>
    <%- include('partials/header', {session: session}); %>
    
    <div class="w-full layout-container lc-home">
        <div class="index-layout">
            <%- include('partials/admin-cat'); %>
            <div class="body-container">
        
                <main class="index-content">
                    <div class="form-section achievement-edit-container">
                        <h1>Edit "<%= achievement.name %>" Achievement</h1>
                        <form action="/admin/edit-achievement/<%= achievement.id %>" method="POST" class="styled-form achievement-edit-form" id="achievementForm">
                            <div id="achievement-name-group">
                                <label for="name">Achievement Name:</label>
                                <input id="achievement-name-input" type="text" name="name" value="<%= achievement.name %>" maxlength="50" required >
                            </div>
                            
                            <div>
                                <label for="description">Description:</label>
                                <textarea name="description" id="description" oninput="updateCharCount()" rows="4" maxlength="300"><%= achievement.description %></textarea>
                                <small id="charCount">0/300</small>
                            </div>
                            <div class="submit-btns-achievement">
                                <button type="submit" class="btn-primary">Update Achievement</button>
                                <button type="button" class="btn-danger" onclick="deleteAchievement()">Delete</button>
                            </div>
                        </form>
                    </div>
                    
                </main>
            </div> 
        </div>
        
        <div class="ctas space">
        </div>
    </div>
    <script>
        function updateCharCount() {
            const input = document.getElementById("description");
            const charCount = document.getElementById("charCount");
            charCount.textContent = `${input.value.length}/300`;
        }
        function deleteAchievement() {
            if (confirm('Are you sure you want to delete this achievement?')) {
              // Change the form action to the delete endpoint and submit
              var form = document.getElementById('achievementForm');
              form.action = '/admin/delete-achievement/<%= achievement.id %>';
              form.submit();
            }
        }

        // Initialize count on page load
        updateCharCount();
    </script>
    <%- include('partials/footer'); %>
</body>
</html>
